{% if paginator.page %}
  {% assign offset = paginator.page | minus:1 | times:paginator.per_page %}{% assign currentPage = paginator.page %}
{% else %}
  {% assign offset = 0 %}{% assign currentPage = 1 %}
{% endif %}
<div id="blogContainer" class="container-fluid" data-page="{{currentPage}}" data-totalPages="{{paginator.total_pages}}">
<article class="row">
{% for post in site.posts limit:site.paginate offset:offset %}
  <div class="col-xs-6 col-md-4 col-lg-3">
    <div class="thumbnail">
      <a href="{{site.baseurl}}{{post.url}}"><span class="label label-info">{{post.title}}</span></a>
      {% if post.thumb %}
      <img src="{{site.baseurl}}/thumb/{{post.thumb}}" class="img-responsive"/>
      {% endif %}
    </div>
  </div>
{% endfor %}
</article>
</div>
{% assign postCount = site.posts | size %}
{% assign postsCovered = site.paginate | plus:offset %}
{% if postsCovered < postCount %}
<button class="loadMore">Load more posts</button>
{% endif %}
<script>
  $(".loadMore").click(loadMorePosts);
  function loadMorePosts() {
    var _this = this;
    var $blogContainer = $("#blogContainer");
    var nextPage = parseInt($blogContainer.attr("data-page")) + 1;
    var totalPages = parseInt($blogContainer.attr("data-totalPages"));
    $(this).addClass("loading");   
    $.get("page" + nextPage, function (data) {
    var htmlData = $.parseHTML(data);
    var $articles = $(htmlData).find("article");
    $blogContainer.attr("data-page", nextPage).append($articles); 
    if ($blogContainer.attr("data-totalPages") == nextPage) {
      $(".loadMore").remove();}
    $(_this).removeClass("loading");});  
  }
</script>
